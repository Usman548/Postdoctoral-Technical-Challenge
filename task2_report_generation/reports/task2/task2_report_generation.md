# Medical Report Generation with MedGemma-4b-it

**Date:** 2026-02-17 14:28:46

## Model Configuration

- **Model:** google/medgemma-4b-it
- **Quantization:** 4-bit
- **Device:** cpu
- **Samples Evaluated:** 4

## Prompting Strategies Tested

### 1. Basic Prompt

```
Describe this chest X-ray in detail.
```

### 2. Structured Prompt

```
You are an expert radiologist. Analyze this chest X-ray and provide a structured report:

FINDINGS:
- Lung fields: [Describe lung parenchyma, presence of opacities, infiltrates, or consolidations]
- C...
```

### 3. Clinical Prompt

```
You are an expert radiologist specializing in chest imaging.

CLINICAL HISTORY: Patient presents with cough and fever, suspected pneumonia.

TECHNIQUE: Chest X-ray, frontal view

FINDINGS:
[Provide de...
```

### 4. Pneumonia_Focused Prompt

```
Focus on detecting signs of pneumonia in this chest X-ray:
- Are there any airspace opacities or consolidations?
- Is there lobar or multilobar involvement?
- Are there associated findings (pleural ef...
```

### 5. Concise Prompt

```
Provide a brief radiology report for this chest X-ray in 2-3 sentences.
Focus on the most clinically relevant findings.
```

## Prompt Performance Analysis

| Prompt | Avg Words | Agreement with Truth |
|--------|-----------|---------------------|
| basic | 0 | 0.0% |
| structured | 0 | 0.0% |
| clinical | 0 | 0.0% |
| pneumonia_focused | 0 | 0.0% |
| concise | 0 | 0.0% |

## Sample Generated Reports

### Sample 0 (True: Pneumonia)

**Basic Prompt:**

```
Error generating report: Prompt contained 0 image tokens but received 1 images.
```

**Structured Prompt:**

```
Error generating report: Prompt contained 0 image tokens but received 1 images.
```

---

### Sample 1 (True: Normal)

**Basic Prompt:**

```
Error generating report: Prompt contained 0 image tokens but received 1 images.
```

**Structured Prompt:**

```
Error generating report: Prompt contained 0 image tokens but received 1 images.
```

---

### Sample 2 (True: Pneumonia)

**Basic Prompt:**

```
Error generating report: Prompt contained 0 image tokens but received 1 images.
```

**Structured Prompt:**

```
Error generating report: Prompt contained 0 image tokens but received 1 images.
```

---

### Sample 3 (True: Normal)

**Basic Prompt:**

```
Error generating report: Prompt contained 0 image tokens but received 1 images.
```

**Structured Prompt:**

```
Error generating report: Prompt contained 0 image tokens but received 1 images.
```

---

## Visualizations

The following visualizations have been generated:

- `figures/sample_*_report.png` - Sample images with generated reports
- `generated_reports/all_reports.json` - All generated reports in JSON format
- `generated_reports/quality_analysis.json` - Quality analysis results

## Model Strengths and Limitations

### Strengths
- Generates clinically relevant descriptions
- Follows radiology report structure with appropriate prompting
- Handles both normal and abnormal cases
- Multiple prompting strategies allow for different levels of detail

### Limitations
- May hallucinate findings not present in the image
- Requires careful prompt engineering for optimal results
- Computationally expensive (requires GPU)
- 28x28 image resolution limits detail perception

### Recommendations for Improvement
- Best performing prompt: 'basic' with 0.0% agreement
- Consider fine-tuning MedGemma on specific report structure
- Add more clinical context in prompts for better accuracy
- Evaluate on more diverse cases to test generalization

---
*Report generated by MedGemma-4b-it medical VLM*
